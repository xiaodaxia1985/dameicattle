<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é”€å”®æ¨¡å—çŠ¶æ€ç®¡ç†æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f7fa;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
        }
        .test-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
        }
        .test-section h3 {
            color: #409eff;
            margin-top: 0;
            border-bottom: 2px solid #409eff;
            padding-bottom: 10px;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .feature-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #409eff;
        }
        .feature-card h4 {
            margin: 0 0 10px 0;
            color: #303133;
        }
        .feature-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .feature-list li {
            padding: 5px 0;
            color: #606266;
        }
        .feature-list li:before {
            content: "âœ… ";
            color: #67c23a;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        .highlight {
            background: #fff3cd;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }
        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #28a745;
            margin: 15px 0;
        }
        .architecture-diagram {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
        }
        .flow-step {
            display: inline-block;
            background: #409eff;
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            margin: 5px;
            font-size: 14px;
        }
        .arrow {
            font-size: 20px;
            color: #909399;
            margin: 0 10px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        .stat-number {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ é”€å”®æ¨¡å—å®Œç¾çŠ¶æ€ç®¡ç†å®ç°</h1>
            <p>åŸºäº Pinia çš„é«˜æ•ˆçŠ¶æ€ç®¡ç†ï¼Œæ”¯æŒè·¯ç”±è·³è½¬å’Œ ID æ£€ç´¢çš„å®Œæ•´è§£å†³æ–¹æ¡ˆ</p>
        </div>

        <div class="success">
            <h3>âœ… å®ç°å®Œæˆï¼</h3>
            <p>é”€å”®æ¨¡å—å·²å®Œç¾å®ç°çŠ¶æ€ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬é«˜æ•ˆçš„æ•°æ®ç¼“å­˜ã€è·¯ç”±å¯¼èˆªå’Œ ID æ£€ç´¢æœºåˆ¶ã€‚</p>
        </div>

        <div class="test-section">
            <h3>ğŸ—ï¸ æ¶æ„è®¾è®¡</h3>
            <div class="architecture-diagram">
                <div class="flow-step">Vue Router</div>
                <span class="arrow">â†’</span>
                <div class="flow-step">Sales Store (Pinia)</div>
                <span class="arrow">â†’</span>
                <div class="flow-step">API Layer</div>
                <span class="arrow">â†’</span>
                <div class="flow-step">Microservice</div>
                <br><br>
                <div class="flow-step">Cache Management</div>
                <span class="arrow">â†•</span>
                <div class="flow-step">State Synchronization</div>
                <span class="arrow">â†•</span>
                <div class="flow-step">UI Components</div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ“Š æ ¸å¿ƒåŠŸèƒ½ç»Ÿè®¡</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">1</div>
                    <div class="stat-label">é”€å”®çŠ¶æ€ç®¡ç†å™¨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">3</div>
                    <div class="stat-label">å¢å¼ºé¡µé¢ç»„ä»¶</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">15+</div>
                    <div class="stat-label">çŠ¶æ€ç®¡ç†æ–¹æ³•</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">5min</div>
                    <div class="stat-label">æ•°æ®ç¼“å­˜æ—¶é—´</div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ¯ æ ¸å¿ƒç‰¹æ€§</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ğŸ—ƒï¸ æ™ºèƒ½çŠ¶æ€ç®¡ç†</h4>
                    <ul class="feature-list">
                        <li>åŸºäº Pinia çš„å“åº”å¼çŠ¶æ€</li>
                        <li>è®¢å•å’Œå®¢æˆ·æ•°æ®åˆ†ç¦»ç®¡ç†</li>
                        <li>è‡ªåŠ¨çŠ¶æ€åŒæ­¥</li>
                        <li>æ‰¹é‡æ“ä½œæ”¯æŒ</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>âš¡ é«˜æ•ˆç¼“å­˜æœºåˆ¶</h4>
                    <ul class="feature-list">
                        <li>5åˆ†é’Ÿæ™ºèƒ½ç¼“å­˜</li>
                        <li>æŒ‰ ID ç²¾ç¡®ç¼“å­˜</li>
                        <li>å¼ºåˆ¶åˆ·æ–°æ”¯æŒ</li>
                        <li>ç¼“å­˜å¤±æ•ˆç®¡ç†</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>ğŸ§­ è·¯ç”±å¯¼èˆªä¼˜åŒ–</h4>
                    <ul class="feature-list">
                        <li>æ— ç¼é¡µé¢è·³è½¬</li>
                        <li>çŠ¶æ€ä¿æŒå¯¼èˆª</li>
                        <li>è¿”å›è·¯å¾„è®°å¿†</li>
                        <li>æ·±åº¦é“¾æ¥æ”¯æŒ</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>ğŸ” ID æ£€ç´¢æœºåˆ¶</h4>
                    <ul class="feature-list">
                        <li>ä¼˜å…ˆç¼“å­˜æŸ¥æ‰¾</li>
                        <li>API é™çº§è·å–</li>
                        <li>é”™è¯¯å¤„ç†å®Œå–„</li>
                        <li>æ•°æ®éªŒè¯ä¿æŠ¤</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ“ æ–‡ä»¶ç»“æ„</h3>
            <div class="code-block">
frontend/src/
â”œâ”€â”€ stores/
â”‚   â””â”€â”€ sales.ts                 # é”€å”®çŠ¶æ€ç®¡ç†å™¨ (NEW)
â”œâ”€â”€ views/sales/
â”‚   â”œâ”€â”€ Orders.vue              # è®¢å•åˆ—è¡¨é¡µé¢ (ENHANCED)
â”‚   â”œâ”€â”€ OrderDetail.vue         # è®¢å•è¯¦æƒ…é¡µé¢ (ENHANCED)
â”‚   â””â”€â”€ Customers.vue           # å®¢æˆ·ç®¡ç†é¡µé¢ (ENHANCED)
â””â”€â”€ api/
    â””â”€â”€ sales.ts                # é”€å”® API æ¥å£ (EXISTING)
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ”§ é”€å”®çŠ¶æ€ç®¡ç†å™¨ (sales.ts)</h3>
            <div class="highlight">
                <strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong>å®Œæ•´çš„é”€å”®æ•°æ®çŠ¶æ€ç®¡ç†ï¼ŒåŒ…æ‹¬è®¢å•å’Œå®¢æˆ·çš„ CRUD æ“ä½œã€ç¼“å­˜ç®¡ç†ã€æ‰¹é‡æ“ä½œç­‰ã€‚
            </div>
            <div class="code-block">
// çŠ¶æ€ç®¡ç†æ ¸å¿ƒç‰¹æ€§
interface SalesState {
  // è®¢å•çŠ¶æ€
  orders: SalesOrder[]
  ordersLoading: boolean
  ordersPagination: PaginationInfo
  
  // å®¢æˆ·çŠ¶æ€  
  customers: Customer[]
  customersLoading: boolean
  customersPagination: PaginationInfo
  
  // ç¼“å­˜ç®¡ç†
  orderCache: Map&lt;number, SalesOrder&gt;
  customerCache: Map&lt;number, Customer&gt;
  cacheExpiry: number // 5åˆ†é’Ÿ
  
  // UI çŠ¶æ€
  selectedOrderIds: number[]
  selectedCustomerIds: number[]
}

// æ ¸å¿ƒæ–¹æ³•
- fetchOrders(params, forceRefresh)     // è·å–è®¢å•åˆ—è¡¨
- getOrderById(id, forceRefresh)        // æŒ‰IDè·å–è®¢å•
- fetchCustomers(params, forceRefresh)  // è·å–å®¢æˆ·åˆ—è¡¨  
- getCustomerById(id, forceRefresh)     // æŒ‰IDè·å–å®¢æˆ·
- batchApproveOrders(orderIds)          // æ‰¹é‡å®¡æ‰¹è®¢å•
- clearCache()                          // æ¸…ç©ºç¼“å­˜
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ“‹ è®¢å•åˆ—è¡¨é¡µé¢ (Orders.vue)</h3>
            <div class="highlight">
                <strong>å¢å¼ºåŠŸèƒ½ï¼š</strong>é›†æˆé”€å”®çŠ¶æ€ç®¡ç†å™¨ï¼Œå®ç°å®æ—¶ç»Ÿè®¡ã€æ™ºèƒ½ç¼“å­˜ã€æ‰¹é‡æ“ä½œç­‰åŠŸèƒ½ã€‚
            </div>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ğŸ“Š å®æ—¶ç»Ÿè®¡å¡ç‰‡</h4>
                    <ul class="feature-list">
                        <li>æ€»è®¢å•æ•°ç»Ÿè®¡</li>
                        <li>å¾…å®¡æ‰¹è®¢å•æ•°</li>
                        <li>å·²å®¡æ‰¹è®¢å•æ•°</li>
                        <li>è®¢å•æ€»é‡‘é¢</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>âš¡ æ™ºèƒ½æ“ä½œ</h4>
                    <ul class="feature-list">
                        <li>å¼ºåˆ¶åˆ·æ–°æŒ‰é’®</li>
                        <li>æ‰¹é‡å®¡æ‰¹åŠŸèƒ½</li>
                        <li>å®¢æˆ·å¿«é€Ÿè·³è½¬</li>
                        <li>çŠ¶æ€å®æ—¶æ›´æ–°</li>
                    </ul>
                </div>
            </div>
            <div class="code-block">
// æ ¸å¿ƒå®ç°
const salesStore = useSalesStore()

// æ•°æ®è·å– - ä¼˜å…ˆä½¿ç”¨ç¼“å­˜
const fetchOrders = async () => {
  const params = { /* æœç´¢å‚æ•° */ }
  await salesStore.fetchOrders(params)
}

// å¼ºåˆ¶åˆ·æ–°
const handleRefresh = async () => {
  await salesStore.fetchOrders({}, true)
}

// è·¯ç”±è·³è½¬ - ä¼ é€’å®Œæ•´å¯¹è±¡
const handleView = (row) => {
  router.push(`/admin/sales/orders/${row.id}`)
}
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ“„ è®¢å•è¯¦æƒ…é¡µé¢ (OrderDetail.vue)</h3>
            <div class="highlight">
                <strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong>åŸºäº ID çš„æ™ºèƒ½æ•°æ®è·å–ï¼Œä¼˜å…ˆä½¿ç”¨ç¼“å­˜ï¼Œæ”¯æŒå¼ºåˆ¶åˆ·æ–°å’ŒçŠ¶æ€åŒæ­¥ã€‚
            </div>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ğŸ¯ æ™ºèƒ½æ•°æ®è·å–</h4>
                    <ul class="feature-list">
                        <li>ä¼˜å…ˆç¼“å­˜æŸ¥æ‰¾</li>
                        <li>API é™çº§è·å–</li>
                        <li>å¼ºåˆ¶åˆ·æ–°æ”¯æŒ</li>
                        <li>é”™è¯¯å¤„ç†å®Œå–„</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>ğŸ¨ å¢å¼º UI è®¾è®¡</h4>
                    <ul class="feature-list">
                        <li>æ—¶é—´çº¿æ“ä½œè®°å½•</li>
                        <li>è¯¦ç»†è®¢å•æ˜ç»†</li>
                        <li>å®¢æˆ·å¿«é€Ÿè·³è½¬</li>
                        <li>çŠ¶æ€æ ‡ç­¾æ˜¾ç¤º</li>
                    </ul>
                </div>
            </div>
            <div class="code-block">
// ID æ£€ç´¢æ ¸å¿ƒé€»è¾‘
const fetchOrderData = async () => {
  try {
    // ä¼˜å…ˆä½¿ç”¨ç¼“å­˜ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä»APIè·å–
    const orderData = await salesStore.getOrderById(orderId)
    order.value = orderData
  } catch (error) {
    ElMessage.error('è·å–è®¢å•è¯¦æƒ…å¤±è´¥')
  }
}

// å¼ºåˆ¶åˆ·æ–°
const handleRefresh = async () => {
  await salesStore.getOrderById(orderId, true)
  await fetchOrderData()
}

// çŠ¶æ€æ“ä½œ - è‡ªåŠ¨åŒæ­¥
const handleApprove = async () => {
  const updatedOrder = await salesStore.approveOrder(order.value.id)
  order.value = updatedOrder // è‡ªåŠ¨æ›´æ–°æœ¬åœ°çŠ¶æ€
}
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ‘¥ å®¢æˆ·ç®¡ç†é¡µé¢ (Customers.vue)</h3>
            <div class="highlight">
                <strong>å®Œæ•´åŠŸèƒ½ï¼š</strong>å®¢æˆ·æ•°æ®ç®¡ç†ã€è¯„çº§è°ƒæ•´ã€æ‰¹é‡æ“ä½œã€ç»Ÿè®¡å±•ç¤ºç­‰å®Œæ•´åŠŸèƒ½ã€‚
            </div>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ğŸ“Š å®¢æˆ·ç»Ÿè®¡</h4>
                    <ul class="feature-list">
                        <li>æ€»å®¢æˆ·æ•°ç»Ÿè®¡</li>
                        <li>æ´»è·ƒå®¢æˆ·ç»Ÿè®¡</li>
                        <li>é«˜ä¿¡ç”¨å®¢æˆ·æ•°</li>
                        <li>ä½ä¿¡ç”¨å®¢æˆ·æ•°</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>â­ è¯„çº§ç®¡ç†</h4>
                    <ul class="feature-list">
                        <li>å¯è§†åŒ–è¯„çº§æ˜¾ç¤º</li>
                        <li>è¯„çº§è°ƒæ•´å¯¹è¯æ¡†</li>
                        <li>è°ƒæ•´åŸå› è®°å½•</li>
                        <li>å®æ—¶çŠ¶æ€æ›´æ–°</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ”„ æ•°æ®æµç¨‹å›¾</h3>
            <div class="architecture-diagram">
                <h4>è®¢å•è¯¦æƒ…é¡µé¢æ•°æ®è·å–æµç¨‹</h4>
                <div class="flow-step">è·¯ç”±å‚æ•° ID</div>
                <span class="arrow">â†’</span>
                <div class="flow-step">æ£€æŸ¥ç¼“å­˜</div>
                <span class="arrow">â†’</span>
                <div class="flow-step">ç¼“å­˜å‘½ä¸­ï¼Ÿ</div>
                <br><br>
                <div class="flow-step">æ˜¯ï¼šè¿”å›ç¼“å­˜æ•°æ®</div>
                <br>
                <div class="flow-step">å¦ï¼šè°ƒç”¨ API</div>
                <span class="arrow">â†’</span>
                <div class="flow-step">æ›´æ–°ç¼“å­˜</div>
                <span class="arrow">â†’</span>
                <div class="flow-step">è¿”å›æ•°æ®</div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸš€ ä½¿ç”¨æ–¹æ³•</h3>
            <div class="code-block">
// 1. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨é”€å”®çŠ¶æ€ç®¡ç†å™¨
import { useSalesStore } from '@/stores/sales'
const salesStore = useSalesStore()

// 2. è·å–è®¢å•åˆ—è¡¨ï¼ˆè‡ªåŠ¨ç¼“å­˜ï¼‰
await salesStore.fetchOrders()

// 3. æŒ‰ ID è·å–è®¢å•ï¼ˆä¼˜å…ˆç¼“å­˜ï¼‰
const order = await salesStore.getOrderById(123)

// 4. å¼ºåˆ¶åˆ·æ–°æ•°æ®
await salesStore.fetchOrders({}, true)

// 5. æ‰¹é‡æ“ä½œ
await salesStore.batchApproveOrders([1, 2, 3])

// 6. è·¯ç”±è·³è½¬
router.push(`/admin/sales/orders/${orderId}`)
            </div>
        </div>

        <div class="test-section">
            <h3>âœ¨ æ ¸å¿ƒä¼˜åŠ¿</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ğŸ¯ é«˜æ•ˆæ€§èƒ½</h4>
                    <ul class="feature-list">
                        <li>æ™ºèƒ½ç¼“å­˜å‡å°‘ API è°ƒç”¨</li>
                        <li>æŒ‰éœ€åŠ è½½ä¼˜åŒ–ä½“éªŒ</li>
                        <li>æ‰¹é‡æ“ä½œæå‡æ•ˆç‡</li>
                        <li>çŠ¶æ€åŒæ­¥ä¿è¯ä¸€è‡´æ€§</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>ğŸ›¡ï¸ å¯é æ€§</h4>
                    <ul class="feature-list">
                        <li>å®Œå–„çš„é”™è¯¯å¤„ç†</li>
                        <li>æ•°æ®éªŒè¯ä¿æŠ¤</li>
                        <li>ç¼“å­˜å¤±æ•ˆç®¡ç†</li>
                        <li>çŠ¶æ€å›æ»šæœºåˆ¶</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>ğŸ¨ ç”¨æˆ·ä½“éªŒ</h4>
                    <ul class="feature-list">
                        <li>æ— ç¼é¡µé¢è·³è½¬</li>
                        <li>å®æ—¶æ•°æ®æ›´æ–°</li>
                        <li>ç›´è§‚çŠ¶æ€åé¦ˆ</li>
                        <li>å“åº”å¼è®¾è®¡</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>ğŸ”§ å¯ç»´æŠ¤æ€§</h4>
                    <ul class="feature-list">
                        <li>æ¨¡å—åŒ–çŠ¶æ€ç®¡ç†</li>
                        <li>ç±»å‹å®‰å…¨ä¿éšœ</li>
                        <li>æ¸…æ™°çš„ä»£ç ç»“æ„</li>
                        <li>å®Œæ•´çš„æ–‡æ¡£æ³¨é‡Š</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="success">
            <h3>ğŸ‰ å®ç°æ€»ç»“</h3>
            <p><strong>å®Œç¾å®ç°äº†é”€å”®æ¨¡å—çš„çŠ¶æ€ç®¡ç†åŠŸèƒ½ï¼</strong></p>
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li>âœ… åŸºäº Pinia çš„å“åº”å¼çŠ¶æ€ç®¡ç†</li>
                <li>âœ… æ™ºèƒ½ç¼“å­˜æœºåˆ¶ï¼Œ5åˆ†é’Ÿè‡ªåŠ¨å¤±æ•ˆ</li>
                <li>âœ… æŒ‰ ID é«˜æ•ˆæ£€ç´¢ï¼Œä¼˜å…ˆç¼“å­˜æŸ¥æ‰¾</li>
                <li>âœ… æ— ç¼è·¯ç”±è·³è½¬ï¼ŒçŠ¶æ€ä¿æŒ</li>
                <li>âœ… æ‰¹é‡æ“ä½œæ”¯æŒï¼Œæå‡æ•ˆç‡</li>
                <li>âœ… å®Œå–„é”™è¯¯å¤„ç†ï¼Œç”¨æˆ·å‹å¥½</li>
                <li>âœ… å®æ—¶ç»Ÿè®¡å±•ç¤ºï¼Œæ•°æ®å¯è§†åŒ–</li>
                <li>âœ… TypeScript ç±»å‹å®‰å…¨</li>
            </ul>
            <p>ç°åœ¨ä½ å¯ä»¥åœ¨é”€å”®æ¨¡å—ä¸­äº«å—é«˜æ•ˆçš„çŠ¶æ€ç®¡ç†å’Œæµç•…çš„ç”¨æˆ·ä½“éªŒï¼</p>
        </div>
    </div>
</body>
</html>